<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>15. 3Sum å®Œæ•´è¦–è¦ºåŒ–æ•™å­¸ç‰ˆ</title>
  <style>
    :root {
      --primary: #007acc; --success: #2ecc71; --danger: #e74c3c;
      --warning: #f39c12; --bg: #f4f7f9; --dark: #2c3e50;
    }
    body { font-family: 'Segoe UI', sans-serif; padding: 20px; background: var(--bg); color: var(--dark); line-height: 1.6; }
    h1 { text-align: center; color: var(--primary); }
    
    .card { background: #fff; padding: 1.5rem; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 2rem; }
    
    /* é¡Œç›®è³‡è¨Šå€ */
    .problem-header { display: grid; grid-template-columns: 1.2fr 1fr; gap: 20px; margin-bottom: 10px; }
    .example-box { background: #f8f9fa; padding: 15px; border-left: 4px solid var(--warning); font-family: monospace; font-size: 0.9rem; border-radius: 0 8px 8px 0; }

    /* é™£åˆ—è¦–è¦ºåŒ– */
    .array { display: flex; justify-content: center; gap: 10px; margin: 3rem 0; flex-wrap: wrap; height: 60px; align-items: flex-end;}
    .element {
      position: relative; width: 45px; height: 45px;
      background: #3498db; color: white; font-weight: bold;
      border-radius: 8px; display: flex; align-items: center; justify-content: center;
      transition: all 0.3s;
    }
    .element.sorted { background: #bdc3c7; color: #2c3e50; border: 1px solid #95a5a6; }
    
    /* æŒ‡é‡æ¨£å¼ */
    .pointer {
      position: absolute; top: -38px; left: 50%; transform: translateX(-50%);
      font-size: 14px; font-weight: bold; color: white;
      padding: 2px 8px; border-radius: 4px; z-index: 10;
    }
    .pointer::after {
      content: ''; position: absolute; bottom: -5px; left: 50%; 
      transform: translateX(-50%); border-left: 5px solid transparent;
      border-right: 5px solid transparent; border-top: 5px solid currentColor;
    }
    .p-i { background: #9b59b6; color: #9b59b6; color: white; }
    .p-j { background: #f1c40f; color: black; }
    .p-k { background: #e67e22; color: white; }
    .p-l { background: #2ecc71; color: white; }
    .p-r { background: #e74c3c; color: white; }

    /* æ§åˆ¶é¢æ¿ */
    .controls { text-align: center; margin: 20px 0; display: flex; justify-content: center; align-items: center; gap: 10px; flex-wrap: wrap; }
    select, input, button { padding: 10px 15px; border-radius: 25px; border: 2px solid #ddd; outline: none; }
    button { background: var(--primary); color: white; border: none; cursor: pointer; font-weight: bold; min-width: 100px; }
    button:hover { opacity: 0.9; }
    button:disabled { background: #ccc; cursor: not-allowed; }

    /* ç¨‹å¼ç¢¼å€å¡Š - åš´æ ¼ç¸®æ’ */
    .code-container { display: grid; grid-template-columns: 1fr 1.2fr; gap: 20px; }
    .code-box { background: #282c34; color: #abb2bf; padding: 1.2rem; border-radius: 8px; font-family: 'Consolas', monospace; font-size: 0.9rem; line-height: 1.5; }
    .code-line { padding: 0 8px; border-left: 4px solid transparent; white-space: pre; }
    .active-line { background: #3e4451; border-left-color: var(--success); color: white; }
    
    .status-msg { text-align: center; font-weight: bold; color: var(--primary); min-height: 1.5rem; margin-bottom: 10px; font-size: 1.1rem; }
    .triplets-display { margin-top: 1rem; padding: 15px; background: #e8f4fd; border-radius: 8px; text-align: center; font-family: monospace; border: 1px dashed var(--primary); }
    
    table { width: 100%; border-collapse: collapse; margin-top: 10px; background: white; }
    th, td { border: 1px solid #eee; padding: 10px; text-align: center; }
    th { background: #f9f9f9; }
  </style>
</head>
<body>

<div class="card">
  <h2>ğŸ“Œ LeetCode 15. 3Sum</h2>
  <div class="problem-header">
    <div>
      <strong>é¡Œç›®æè¿°ï¼š</strong><br>
      çµ¦ä½ ä¸€å€‹åŒ…å« <code>n</code> å€‹æ•´æ•¸çš„é™£åˆ— <code>nums</code>ï¼Œåˆ¤æ–· <code>nums</code> ä¸­æ˜¯å¦å­˜åœ¨ä¸‰å€‹å…ƒç´  <code>i, j, k</code>ï¼Œä½¿å¾— <code>i != j, i != k, j != k</code>ï¼Œä¸”æ»¿è¶³ <code>nums[i] + nums[j] + nums[k] == 0</code>ã€‚
      <br><br>
      <strong>æ³¨æ„ï¼š</strong>ç­”æ¡ˆä¸­ä¸å¯ä»¥åŒ…å«é‡è¤‡çš„ä¸‰å…ƒçµ„ã€‚
    </div>
    <div class="example-box">
      <strong>ç¯„ä¾‹ï¼š</strong><br>
      Input: nums = [-1, 0, 1, 2, -1, -4]<br>
      Sorted: [-4, -1, -1, 0, 1, 2]<br>
      Output: [[-1, -1, 2], [-1, 0, 1]]
    </div>
  </div>

  <div class="controls">
    è§£æ³•ï¼š
    <select id="algoSelect" onchange="initSim()">
      <option value="sol1">Sol 1: æš´åŠ›æ³• (O(nÂ³))</option>
      <option value="sol2" selected>Sol 2: æ’åº + é›™æŒ‡é‡ (O(nÂ²))</option>
    </select>
    è¼¸å…¥ï¼š<input id="inputArr" value="-1, 0, 1, 2, -1, -4" size="20">
    <button onclick="initSim()">é‡ç½®</button>
    <button id="nextBtn" onclick="step()">ä¸‹ä¸€æ­¥ (Step)</button>
  </div>

  <div class="status-msg" id="statusMsg">é»æ“Šä¸‹ä¸€æ­¥é–‹å§‹</div>
  <div class="array" id="arrayBox"></div>
  <div class="triplets-display" id="tripletBox">Result Set: []</div>
</div>

<div class="code-container">
  <div class="card">
    <h3>Python Code Trace</h3>
    <div class="code-box" id="codeBox"></div>
  </div>
  <div class="card">
    <h3>ğŸ“Š è¤‡é›œåº¦åˆ†æ</h3>
    <table>
      <tr><th>æ–¹æ³•</th><th>æ™‚é–“è¤‡é›œåº¦</th><th>ç©ºé–“è¤‡é›œåº¦</th></tr>
      <tr><td>æš´åŠ›æ³•</td><td style="color:var(--danger)">O(nÂ³)</td><td>O(k)</td></tr>
      <tr><td>é›™æŒ‡é‡</td><td style="color:var(--success)">O(nÂ²)</td><td>O(log n) ~ O(n)</td></tr>
    </table>
    <p style="font-size: 0.9rem;">
      <strong>ç‚ºä»€éº¼é›™æŒ‡é‡æ›´å¿«ï¼Ÿ</strong><br>
      æš´åŠ›æ³•ç›²ç›®éæ­·æ‰€æœ‰çµ„åˆã€‚é›™æŒ‡é‡åˆ©ç”¨ã€Œæ’åºã€å¾Œçš„å–®èª¿æ€§ï¼Œæ ¹æ“šç›®å‰çš„ <code>Sum</code> å¤§å°æ±ºå®šç§»å‹•æ–¹å‘ï¼Œå°‡åŸæœ¬éœ€è¦å…©å±¤è¿´åœˆå°‹æ‰¾ <code>j</code> å’Œ <code>k</code> çš„éç¨‹å„ªåŒ–ç‚ºä¸€æ¬¡ç·šæ€§æƒæã€‚
    </p>
  </div>
</div>

<script>
const codeData = {
  sol1: [
    "def threeSum(nums):",
    "    res = set()",
    "    for i in range(len(nums)):",
    "        for j in range(i + 1, len(nums)):",
    "            for k in range(j + 1, len(nums)):",
    "                if nums[i] + nums[j] + nums[k] == 0:",
    "                    res.add(tuple(sorted([nums[i], nums[j], nums[k]])))",
    "    return list(res)"
  ],
  sol2: [
    "nums.sort()",
    "for i in range(len(nums) - 2):",
    "    if i > 0 and nums[i] == nums[i - 1]: continue",
    "    l, r = i + 1, len(nums) - 1",
    "    while l < r:",
    "        total = nums[i] + nums[l] + nums[r]",
    "        if total < 0: l += 1",
    "        elif total > 0: r -= 1",
    "        else:",
    "            ans.append([nums[i], nums[l], nums[r]])",
    "            while l < r and nums[l] == nums[l+1]: l += 1",
    "            while l < r and nums[r] == nums[r-1]: r -= 1",
    "            l += 1; r -= 1"
  ]
};

let nums = [], i = 0, j = 1, k = 2, l = 0, r = 0, triplets = [], phase = "loop";

function initSim() {
  const algo = document.getElementById("algoSelect").value;
  const inputStr = document.getElementById("inputArr").value;
  let raw = inputStr.split(',').map(n => parseInt(n.trim())).filter(n => !isNaN(n));
  
  if (algo === "sol2") {
    nums = raw.sort((a, b) => a - b);
    i = 0; l = 1; r = nums.length - 1;
  } else {
    nums = raw;
    i = 0; j = 1; k = 2;
  }
  
  triplets = [];
  phase = "loop";
  document.getElementById("nextBtn").disabled = false;
  document.getElementById("statusMsg").innerText = "å·²åˆå§‹åŒ–è³‡æ–™";
  renderCode(algo);
  renderArray(algo);
  updateTriplets();
}

function renderCode(algo) {
  document.getElementById("codeBox").innerHTML = codeData[algo].map((line, idx) => 
    `<div class="code-line" id="l-${idx}">${line}</div>`
  ).join("");
}

function renderArray(algo) {
  const box = document.getElementById("arrayBox");
  box.innerHTML = "";
  nums.forEach((val, idx) => {
    const div = document.createElement("div");
    div.className = `element ${algo === "sol2" ? "sorted" : ""}`;
    div.innerText = val;
    if (idx === i) div.innerHTML += '<div class="pointer p-i">i</div>';
    if (algo === "sol1") {
      if (idx === j) div.innerHTML += '<div class="pointer p-j">j</div>';
      if (idx === k) div.innerHTML += '<div class="pointer p-k">k</div>';
    } else {
      if (idx === l && i < nums.length - 2) div.innerHTML += '<div class="pointer p-l">l</div>';
      if (idx === r && i < nums.length - 2) div.innerHTML += '<div class="pointer p-r">r</div>';
    }
    box.appendChild(div);
  });
}

function step() {
  const algo = document.getElementById("algoSelect").value;
  document.querySelectorAll(".code-line").forEach(el => el.classList.remove("active-line"));

  if (algo === "sol1") {
    if (i > nums.length - 3) { finish(); return; }
    document.getElementById("l-5").classList.add("active-line");
    const sum = nums[i] + nums[j] + nums[k];
    if (sum === 0) {
      const triplet = [nums[i], nums[j], nums[k]].sort((a,b)=>a-b);
      const key = triplet.join(',');
      if (!triplets.some(t => t.join(',') === key)) {
        triplets.push(triplet);
        document.getElementById("statusMsg").innerText = `Bingo! æ‰¾åˆ°çµ„åˆ: [${triplet}]`;
      }
    }
    k++;
    if (k >= nums.length) { j++; k = j + 1; }
    if (j >= nums.length - 1) { i++; j = i + 1; k = j + 1; }
  } else {
    if (i > nums.length - 3) { finish(); return; }
    if (phase === "loop") {
      document.getElementById("l-2").classList.add("active-line");
      if (i > 0 && nums[i] === nums[i-1]) { i++; return; }
      l = i + 1; r = nums.length - 1; phase = "while";
    } else if (l < r) {
      document.getElementById("l-5").classList.add("active-line");
      const sum = nums[i] + nums[l] + nums[r];
      if (sum < 0) {
        document.getElementById("l-6").classList.add("active-line");
        l++;
      } else if (sum > 0) {
        document.getElementById("l-7").classList.add("active-line");
        r--;
      } else {
        document.getElementById("l-9").classList.add("active-line");
        triplets.push([nums[i], nums[l], nums[r]]);
        while (l < r && nums[l] === nums[l+1]) l++;
        while (l < r && nums[r] === nums[r-1]) r--;
        l++; r--;
      }
    } else {
      i++; phase = "loop";
    }
  }
  renderArray(algo);
  updateTriplets();
}

function finish() {
  document.getElementById("statusMsg").innerText = "æƒæçµæŸï¼";
  document.getElementById("nextBtn").disabled = true;
}

function updateTriplets() {
  document.getElementById("tripletBox").innerText = "Result Set: " + JSON.stringify(triplets);
}

initSim();
</script>
</body>
</html>