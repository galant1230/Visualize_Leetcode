<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>LeetCode 198. House Robber - æ·±åº¦é‚è¼¯å…¨è§£æ³•</title>
    <style>
        :root {
            --bg: #0d1117; --panel: #161b22; --border: #30363d;
            --text: #c9d1d9; --blue: #58a6ff; --purple: #bc8cff;
            --orange: #d29922; --green: #3fb950; --red: #f85149;
            --highlight: rgba(56, 139, 253, 0.15); --comment: #8b949e;
        }
        body { 
            background: #010409; color: var(--text); 
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            display: flex; justify-content: center; align-items: center;
            height: 100vh; margin: 0;
        }
        .widget-card {
            width: 1320px; height: 940px;
            background: var(--panel); border: 1px solid var(--border);
            border-radius: 12px; box-shadow: 0 30px 60px rgba(0,0,0,0.8);
            display: flex; flex-direction: column; overflow: hidden;
        }
        /* Header */
        .header {
            padding: 15px 25px; border-bottom: 1px solid var(--border);
            display: flex; justify-content: space-between; align-items: center;
            background: #0d1117;
        }
        .controls { display: flex; gap: 10px; align-items: center; }
        input { background: #010409; color: var(--green); border: 1px solid var(--border); padding: 8px; border-radius: 6px; width: 160px; outline: none; }
        button { background: var(--panel); color: var(--text); border: 1px solid var(--border); padding: 8px 15px; border-radius: 6px; cursor: pointer; font-size: 13px; }
        button:hover { border-color: var(--blue); background: var(--highlight); }

        .content-grid { display: grid; grid-template-columns: 400px 1fr; flex: 1; overflow: hidden; }
        
        /* Sidebar */
        .sidebar { padding: 25px; border-right: 1px solid var(--border); overflow-y: auto; background: rgba(0,0,0,0.2); }
        .sidebar h3 { color: var(--blue); margin-top: 0; font-size: 18px; border-left: 4px solid var(--blue); padding-left: 10px; }
        .sidebar h4 { color: var(--orange); margin-bottom: 8px; font-size: 14px; margin-top: 20px; }
        .section-box { margin-bottom: 15px; padding: 12px; background: #010409; border: 1px solid var(--border); border-radius: 8px; font-size: 13px; line-height: 1.6; }
        .dp-formula-box { border-left: 3px solid var(--orange); padding-left: 10px; margin: 10px 0; font-family: 'Consolas', monospace; color: var(--orange); }
        
        /* ç¯„ä¾‹ block æ¨£å¼ */
        .example-block { background: #0d1117; border: 1px solid var(--blue); padding: 12px; border-radius: 8px; font-family: monospace; font-size: 12px; color: #e6edf3; }
        .example-title { color: var(--blue); font-weight: bold; margin-bottom: 5px; font-family: sans-serif; }

        /* Workspace */
        .workspace { display: grid; grid-template-rows: 1fr 400px; overflow: hidden; }
        .editor-container { display: flex; flex-direction: column; background: #0d1117; }
        .tabs { background: #010409; display: flex; border-bottom: 1px solid var(--border); }
        .tab { padding: 12px 18px; font-size: 12px; color: var(--comment); border-right: 1px solid var(--border); cursor: pointer; font-family: monospace; }
        .tab.active { background: var(--panel); color: var(--text); border-top: 2px solid var(--green); }
        
        .editor { padding: 25px; font-family: 'Fira Code', monospace; font-size: 15px; line-height: 1.7; overflow-y: auto; flex: 1; }
        .line { display: block; padding-left: 50px; position: relative; opacity: 0.3; white-space: pre; }
        .line.active { opacity: 1; background: var(--highlight); box-shadow: inset 4px 0 0 var(--green); }
        .line::before { content: attr(data-ln); position: absolute; left: 10px; color: #484f58; width: 30px; text-align: right; }

        .kw { color: var(--purple); } .fn { color: var(--blue); } .num { color: var(--orange); }

        /* Visualization */
        .viz-section { border-top: 1px solid var(--border); background: #0d1117; padding: 20px; display: grid; grid-template-columns: 1fr 380px; gap: 20px; }
        .viz-main { display: flex; flex-direction: column; gap: 20px; }
        .house-row { display: flex; gap: 10px; justify-content: center; }
        .house { 
            width: 55px; padding: 10px 0; border: 1px solid var(--border); border-radius: 8px; 
            text-align: center; background: var(--panel); transition: 0.3s;
        }
        .house.active { border-color: var(--green); background: rgba(63, 185, 80, 0.1); transform: translateY(-5px); }
        .house.prev-1 { border-color: var(--blue); border-style: dashed; }
        .house.prev-2 { border-color: var(--purple); border-style: dotted; }
        .house .m-val { font-weight: bold; color: var(--orange); font-size: 16px; }
        
        .viz-bars { display: flex; align-items: flex-end; gap: 12px; height: 120px; justify-content: center; }
        .bar-container { display: flex; flex-direction: column; align-items: center; width: 50px; }
        .bar-val { font-family: monospace; font-size: 12px; color: var(--blue); font-weight: bold; margin-bottom: 5px; }
        .bar { width: 35px; background: #21262d; border-radius: 4px 4px 0 0; transition: height 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .bar.active { background: var(--green); box-shadow: 0 0 15px rgba(63, 185, 80, 0.5); }
        
        .terminal { font-family: monospace; font-size: 13px; background: #010409; padding: 18px; border-radius: 10px; border: 1px solid var(--border); overflow-y: auto; }
        .log-item { margin-bottom: 6px; line-height: 1.6; }
        .log-compare { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 8px; padding-top: 8px; border-top: 1px dashed var(--border); }
        .choice { padding: 4px 8px; border-radius: 4px; font-size: 12px; border: 1px solid transparent; }
        .choice.win { background: rgba(63, 185, 80, 0.2); color: var(--green); border: 1px solid var(--green); }
    </style>
</head>
<body>

<div class="widget-card">
    <div class="header">
        <div style="font-weight: bold; color: var(--green); font-size: 18px;">House Robber æ¼”ç®—æ³•æ¨¡æ“¬å™¨</div>
        <div class="controls">
            <span>æˆ¿å±‹é‡‘é¡:</span>
            <input type="text" id="numsInput" value="2, 7, 9, 3, 1" onchange="init()">
            <button onclick="init()">é‡ç½®</button>
            <button onclick="prevStep()">ä¸Šä¸€æ­¥</button>
            <button onclick="nextStep()" style="color: var(--green); border-color: var(--green); font-weight: bold;">ä¸‹ä¸€æ­¥ (F10)</button>
        </div>
    </div>

    <div class="content-grid">
        <div class="sidebar">
            <h3>æ ¸å¿ƒåˆ†æ</h3>
            <div class="section-box">
                <b>ç›®æ¨™ï¼š</b>åœ¨ä¸æ¶åŠ«ç›¸é„°æˆ¿å±‹çš„å‰æä¸‹ï¼Œç²å–æœ€é«˜ç¸½é‡‘é¡ã€‚
            </div>

            <h4>ç¯„ä¾‹èªªæ˜ (LeetCode 198)</h4>
            <div class="example-block">
                <div class="example-title">Example:</div>
                Input: nums = [2,7,9,3,1]<br>
                Output: 12<br>
                Explanation: <br>
                - Rob house 1 (money = 2)<br>
                - Rob house 3 (money = 9)<br>
                - Rob house 5 (money = 1)<br>
                Total: 2 + 9 + 1 = 12.
            </div>
            
            <h4>ç‹€æ…‹è½‰ç§»æ–¹ç¨‹å¼</h4>
            <div class="section-box">
                <div class="dp-formula-box">
                    dp[i] = max(dp[i-1], dp[i-2] + nums[i])
                </div>
                é€™è¡¨ç¤ºåœ¨ç¬¬ i é–“æˆ¿ï¼Œæˆ‘å€‘å–ã€Œæ”¾æ£„é€™é–“ï¼ˆç¶­æŒä¸Šä¸€é–“çš„çµæœï¼‰ã€èˆ‡ã€Œæ¶é€™é–“ï¼ˆç›®å‰åŠ ä¸Šå‰å‰é–“çš„çµæœï¼‰ã€çš„æœ€å¤§å€¼ã€‚
            </div>

            <h4>è¤‡é›œåº¦æ¦‚è¦½</h4>
            <div id="complexityBox" class="section-box">
                æ™‚é–“: O(n)<br>ç©ºé–“: O(n)
            </div>
        </div>

        <div class="workspace">
            <div class="editor-container">
                <div class="tabs">
                    <div class="tab" onclick="changeAlgo('recursion')" id="t-recursion">1_recursion.py</div>
                    <div class="tab" onclick="changeAlgo('topdown')" id="t-topdown">2_top_down.py</div>
                    <div class="tab active" onclick="changeAlgo('bottomup')" id="t-bottomup">3_bottom_up.py</div>
                    <div class="tab" onclick="changeAlgo('optimal')" id="t-optimal">4_optimal.py</div>
                </div>
                <div id="codeEditor" class="editor"></div>
            </div>

            <div class="viz-section">
                <div class="viz-main">
                    <div id="houseRow" class="house-row"></div>
                    <div id="vizBars" class="viz-bars"></div>
                </div>
                <div class="terminal" id="terminal">
                    <div style="color: var(--green); margin-bottom: 10px; font-weight: bold;">ğŸ’¡ åŸ·è¡Œæ—¥èªŒ</div>
                    <div id="logContent"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
let curStep = 0, nums = [], steps = [], curAlgo = 'bottomup';

const repo = {
    recursion: {
        complexity: "æ™‚é–“: O(2^n)<br>ç©ºé–“: O(n)",
        code: [
            `<span class="kw">def</span> <span class="fn">rob</span>(nums, i):`,
            `    <span class="kw">if</span> i < <span class="num">0</span>: <span class="kw">return</span> <span class="num">0</span>`,
            `    <span class="kw">return</span> <span class="fn">max</span>(<span class="fn">rob</span>(nums, i-1), <span class="fn">rob</span>(nums, i-2) + nums[i])`
        ],
        gen: (n) => {
            let dp = getRobDP(nums);
            return [
                {l:1, msg: "ğŸ” æš´åŠ›éè¿´ï¼šå˜—è©¦æ‰€æœ‰å¯èƒ½çš„çµ„åˆï¼ˆæ¶æˆ–ä¸æ¶ï¼‰ã€‚", dp: Array(n).fill(0)},
                {l:3, msg: `ğŸ”€ æ±ºç­–æ¨¹å±•é–‹ï¼š<br>è¨ˆç®— max(ä¸æ¶æœ€å¾Œä¸€é–“, æ¶æœ€å¾Œä¸€é–“ + å‰å‰é–“)ã€‚`, dp: Array(n).fill(0), active: n-1},
                {l:3, msg: `ğŸ›‘ æš´åŠ›éè¿´æœƒå°è‡´å¤§é‡çš„é‡ç–Šå­å•é¡Œï¼Œæ•ˆç‡éå¸¸ä½ã€‚`, dp: dp, res: dp[n-1]}
            ];
        }
    },
    topdown: {
        complexity: "æ™‚é–“: O(n)<br>ç©ºé–“: O(n)",
        code: [
            `<span class="kw">memo</span> = {}`,
            `<span class="kw">def</span> <span class="fn">rob</span>(i):`,
            `    <span class="kw">if</span> i <span class="kw">in</span> <span class="kw">memo</span>: <span class="kw">return</span> <span class="kw">memo</span>[i]`,
            `    <span class="kw">memo</span>[i] = <span class="fn">max</span>(<span class="fn">rob</span>(i-1), <span class="fn">rob</span>(i-2) + nums[i])`,
            `    <span class="kw">return</span> <span class="kw">memo</span>[i]`
        ],
        gen: (n) => {
            let dp = getRobDP(nums);
            let s = [{l:1, msg: "ğŸ§  è¨˜æ†¶åŒ–æœå°‹ï¼šå…ˆæŸ¥è¡¨ï¼Œæ²’æŸ¥åˆ°æ‰è¨ˆç®—ã€‚", dp: Array(n).fill(0)}];
            for(let i=0; i<n; i++) {
                s.push({
                    l:4, 
                    msg: `ğŸ’¾ å¡«å…… Memoï¼š<br>å°‡ç¬¬ ${i} é–“æˆ¿çš„çµæœ ${dp[i]} å­˜å…¥å¿«å–ã€‚`, 
                    dp: [...dp.slice(0,i+1), ...Array(n-i-1).fill(0)], 
                    active: i
                });
            }
            return s;
        }
    },
    bottomup: {
        complexity: "æ™‚é–“: O(n)<br>ç©ºé–“: O(n)",
        code: [
            `<span class="kw">dp</span> = [<span class="num">0</span>] * (n)`,
            `<span class="kw">dp</span>[<span class="num">0</span>], <span class="kw">dp</span>[<span class="num">1</span>] = nums[<span class="num">0</span>], <span class="fn">max</span>(nums[<span class="num">0</span>], nums[<span class="num">1</span>])`,
            `<span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(<span class="num">2</span>, n):`,
            `    <span class="kw">dp</span>[i] = <span class="fn">max</span>(<span class="kw">dp</span>[i-1], <span class="kw">dp</span>[i-2] + nums[i])`,
            `<span class="kw">return</span> <span class="kw">dp</span>[-<span class="num">1</span>]`
        ],
        gen: (n) => {
            let dp = new Array(n).fill(0);
            let s = [{l:1, msg:"ğŸ—ï¸ è‡ªåº•å‘ä¸Šï¼šå¾ç¬¬ä¸€é–“é–‹å§‹é€ä¸€å¡«å¯«æ”¶ç›Šè¡¨ã€‚", dp:[...dp]}];
            dp[0] = nums[0];
            s.push({l:2, msg:`ğŸ  åˆå§‹ç‹€æ…‹ dp[0]ï¼šåªæœ‰ä¸€é–“å¯æ¶ï¼Œæ”¶ç›Š $${dp[0]}ã€‚`, dp:[...dp], active:0});
            if(n > 1) {
                dp[1] = Math.max(nums[0], nums[1]);
                s.push({l:2, msg:`ğŸ  åˆå§‹ç‹€æ…‹ dp[1]ï¼šå‰å…©é–“å–æœ€å¤§çš„æ”¶ç›Š $${dp[1]}ã€‚`, dp:[...dp], active:1, p1:0});
            }
            for(let i=2; i<n; i++) {
                let rob = dp[i-2] + nums[i];
                let skip = dp[i-1];
                dp[i] = Math.max(rob, skip);
                s.push({
                    l:4, msg: `ğŸ  æ±ºç­–ç¬¬ ${i+1} é–“æˆ¿ ($${nums[i]}):`,
                    compare: { rob: { val: rob, formula: `dp[${i-2}](${dp[i-2]}) + ${nums[i]}`, win: rob >= skip },
                               skip: { val: skip, formula: `dp[${i-1}](${dp[i-1]})`, win: skip > rob } },
                    dp:[...dp], active: i, p1: i-1, p2: i-2
                });
            }
            s.push({l:5, msg: `ğŸ è¨ˆç®—å®Œæˆï¼æœ€å¤§å€¼ä¿å­˜åœ¨ dp é™£åˆ—æœ«å°¾ã€‚`, dp:[...dp], res: dp[n-1]});
            return s;
        }
    },
    optimal: {
        complexity: "æ™‚é–“: O(n)<br>ç©ºé–“: O(1)",
        code: [
            `prev2, prev1 = <span class="num">0</span>, <span class="num">0</span>`,
            `<span class="kw">for</span> x <span class="kw">in</span> nums:`,
            `    <span class="kw">cur</span> = <span class="fn">max</span>(prev1, prev2 + x)`,
            `    prev2, prev1 = prev1, <span class="kw">cur</span>`,
            `<span class="kw">return</span> prev1`
        ],
        gen: (n) => {
            let s = [{l:1, msg:"âœ¨ ç©ºé–“å„ªåŒ–ï¼šæˆ‘å€‘åªéœ€è¦å‰å…©æ­¥çš„çµæœï¼Œä¸éœ€è¦æ•´å€‹é™£åˆ—ã€‚", dp:Array(n).fill(0)}];
            let p2=0, p1=0, dp=[];
            nums.forEach((x, i) => {
                let cur = Math.max(p1, p2 + x);
                let winRob = (p2+x) >= p1;
                s.push({
                    l:3, msg:`ğŸ”„ æ»¾å‹•æ›´æ–°è®Šæ•¸ (i=${i}):`,
                    compare: { rob: { val: p2+x, formula: `prev2(${p2}) + ${x}`, win: winRob },
                               skip: { val: p1, formula: `prev1(${p1})`, win: !winRob } },
                    dp:[...dp, cur, ...Array(n-i-1).fill(0)], active: i
                });
                p2 = p1; p1 = cur; dp.push(cur);
            });
            s.push({l:5, msg: "ğŸ å„ªåŒ–å®Œæˆã€‚æœ€çµ‚çµæœå³ç‚ºæœ€å¾Œä¸€æ¬¡è¿­ä»£çš„ prev1ã€‚", dp: dp, res: p1});
            return s;
        }
    }
};

function getRobDP(arr) {
    if(arr.length === 0) return [];
    let d = [arr[0]];
    if(arr.length > 1) d[1] = Math.max(arr[0], arr[1]);
    for(let i=2; i<arr.length; i++) d[i] = Math.max(d[i-1], d[i-2]+arr[i]);
    return d;
}

function changeAlgo(a) { curAlgo = a; init(); }

function init() {
    nums = document.getElementById('numsInput').value.split(',').map(x => parseInt(x.trim())).filter(x => !isNaN(x));
    if(nums.length === 0) nums = [0];
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.getElementById(`t-${curAlgo}`)?.classList.add('active');
    document.getElementById('codeEditor').innerHTML = (repo[curAlgo] || repo.bottomup).code.map((l, i) => `<span class="line" data-ln="${i+1}">${l}</span>`).join('');
    document.getElementById('complexityBox').innerHTML = (repo[curAlgo] || repo.bottomup).complexity;
    
    steps = (repo[curAlgo] || repo.bottomup).gen(nums.length);
    curStep = 0; update();
}

function update() {
    const step = steps[curStep];
    const lines = document.querySelectorAll('.line');
    lines.forEach((l, i) => i === step.l-1 ? l.classList.add('active') : l.classList.remove('active'));
    
    let logHTML = `<div class="log-item">${step.msg}</div>`;
    if(step.compare) {
        logHTML += `
        <div class="log-compare">
            <div class="choice ${step.compare.rob.win ? 'win' : ''}"><b>é¸é …ï¼šæ¶</b><br>${step.compare.rob.formula} = ${step.compare.rob.val}</div>
            <div class="choice ${step.compare.skip.win ? 'win' : ''}"><b>é¸é …ï¼šä¸æ¶</b><br>${step.compare.skip.formula} = ${step.compare.skip.val}</div>
        </div>`;
    }
    document.getElementById('logContent').innerHTML = logHTML;

    const hRow = document.getElementById('houseRow');
    hRow.innerHTML = nums.map((v, i) => {
        let cls = 'house' + (i === step.active ? ' active' : '') + (i === step.p1 ? ' prev-1' : '') + (i === step.p2 ? ' prev-2' : '');
        return `<div class="${cls}"><div class="m-val">${v}</div><div style="font-size:9px">æˆ¿ ${i}</div></div>`;
    }).join('');

    const bRow = document.getElementById('vizBars');
    bRow.innerHTML = '';
    const maxVal = Math.max(...steps[steps.length-1].dp, 1);
    step.dp.forEach((v, i) => {
        const h = (v / maxVal) * 85 + (v > 0 ? 5 : 0);
        bRow.innerHTML += `<div class="bar-container"><span class="bar-val">${v || ''}</span><div class="bar ${i === step.active ? 'active' : ''}" style="height:${h}%"></div><div style="font-size:9px">dp[${i}]</div></div>`;
    });
    
    document.getElementById('retVal').innerText = step.res || (step.dp[step.active] || 0);
}

function nextStep() { if(curStep < steps.length - 1) { curStep++; update(); } }
function prevStep() { if(curStep > 0) { curStep--; update(); } }

init();
</script>
</body>
</html>