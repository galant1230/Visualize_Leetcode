<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>LeetCode 91. Decode Ways - çµ‚æ¥µå››å¤§è§£æ³•</title>
    <style>
        :root {
            --bg: #0d1117; --panel: #161b22; --border: #30363d;
            --text: #c9d1d9; --blue: #569cd6; --purple: #c586c0;
            --orange: #ce9178; --green: #6a9955; --yellow: #dcdcaa;
            --num: #b5cea8; --highlight: rgba(56, 139, 253, 0.1);
        }
        body { background: #010409; color: var(--text); font-family: 'Segoe UI', 'Consolas', monospace; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; overflow: hidden; }
        .widget-card { width: 1450px; height: 940px; background: var(--panel); border: 1px solid var(--border); border-radius: 8px; display: flex; flex-direction: column; }
        
        .header { padding: 12px 25px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; background: #0d1117; }
        input { background: #010409; color: #3fb950; border: 1px solid var(--border); padding: 6px 12px; border-radius: 4px; width: 140px; outline: none; font-family: monospace; }
        button { background: #21262d; color: var(--text); border: 1px solid var(--border); padding: 6px 15px; border-radius: 4px; cursor: pointer; font-size: 13px; transition: 0.2s; }
        button:hover { background: #30363d; border-color: #8b949e; }

        .content-grid { display: grid; grid-template-columns: 380px 1fr; flex: 1; overflow: hidden; }
        .sidebar { padding: 20px; border-right: 1px solid var(--border); overflow-y: auto; background: #0d1117; }
        .sidebar h3 { color: var(--blue); margin-top: 0; font-size: 18px; }
        .sidebar h4 { color: #e6edf3; margin: 15px 0 8px 0; font-size: 14px; border-left: 3px solid var(--blue); padding-left: 8px; }
        .desc-text { font-size: 13px; line-height: 1.6; color: #8b949e; margin-bottom: 10px; }
        .example-box { background: #161b22; padding: 10px; border-radius: 6px; border: 1px solid var(--border); font-family: monospace; font-size: 12px; margin-bottom: 10px; }
        .logic-card { background: rgba(56, 139, 253, 0.05); padding: 10px; border-radius: 6px; font-size: 12px; line-height: 1.5; color: #c9d1d9; border: 1px dashed #30363d; }

        .workspace { display: flex; flex-direction: column; overflow: hidden; background: #0d1117; }
        .tabs { background: #010409; display: flex; border-bottom: 1px solid var(--border); overflow-x: auto; }
        .tab { padding: 12px 20px; font-size: 12px; color: #8b949e; border-right: 1px solid var(--border); cursor: pointer; white-space: nowrap; }
        .tab.active { background: var(--panel); color: #fff; border-top: 2px solid #d29922; }
        
        .editor { padding: 20px; font-size: 14px; line-height: 1.5; overflow-y: auto; flex: 1; background: #0d1117; font-family: 'Consolas', monospace; }
        .line { display: block; padding-left: 50px; position: relative; opacity: 0.4; white-space: pre; }
        .line.active { opacity: 1; background: var(--highlight); box-shadow: inset 4px 0 0 var(--blue); }
        .line::before { content: attr(data-ln); position: absolute; left: 15px; color: #484f58; width: 30px; text-align: right; }
        
        .kw { color: var(--purple); } .fn { color: var(--yellow); } .var { color: #9cdcfe; }
        .num { color: var(--num); } .str { color: var(--orange); } .comment { color: var(--green); }

        .viz-section { height: 350px; border-top: 1px solid var(--border); background: #161b22; padding: 20px; display: grid; grid-template-columns: 1fr 400px; gap: 20px; }
        .viz-main { display: flex; flex-direction: column; align-items: center; justify-content: center; }
        
        .string-row { display: flex; gap: 6px; margin-bottom: 25px; }
        .char-cell { width: 45px; height: 50px; border: 1px solid var(--border); border-radius: 4px; display: flex; align-items: center; justify-content: center; font-size: 18px; font-weight: bold; background: #0d1117; position: relative; }
        .char-cell.active { border-color: var(--blue); color: var(--blue); box-shadow: 0 0 10px rgba(86, 156, 214, 0.3); }
        .ptr-i { position: absolute; top: -22px; font-size: 11px; background: var(--blue); color: #000; padding: 1px 5px; border-radius: 3px; font-weight: bold; }

        .dp-row { display: flex; gap: 5px; }
        .dp-box { width: 50px; height: 60px; border: 1px solid var(--border); display: flex; flex-direction: column; align-items: center; justify-content: center; background: #0d1117; border-radius: 4px; transition: 0.3s; }
        .dp-box.active { border-color: #3fb950; background: rgba(63, 185, 80, 0.1); }
        .dp-label { font-size: 10px; color: #484f58; margin-bottom: 2px; }
        .dp-val { font-size: 16px; color: var(--num); font-weight: bold; }

        .terminal { background: #010409; padding: 15px; border: 1px solid var(--border); border-radius: 8px; font-family: monospace; font-size: 13px; overflow-y: auto; }
        .log-entry { margin-bottom: 8px; line-height: 1.4; border-left: 3px solid #30363d; padding-left: 10px; }
    </style>
</head>
<body>

<div class="widget-card">
    <div class="header">
        <div style="font-weight:bold; font-size:18px;">LeetCode 91. <span style="color:var(--blue)">Decode Ways</span> Lab</div>
        <div style="display: flex; gap: 12px;">
            <input type="text" id="sInput" value="226" maxlength="10">
            <button onclick="init()">Reset</button>
            <button onclick="prevStep()">Prev</button>
            <button onclick="nextStep()" style="color: #3fb950; border-color: #3fb950;">Next (F10)</button>
        </div>
    </div>

    <div class="content-grid">
        <div class="sidebar">
            <h3>ğŸ“– é¡Œç›®è§£æ</h3>
            <div class="desc-text">å°‡æ•¸å­—å­—ä¸²è§£ç¢¼ç‚º A-Z (1-26)ã€‚é€™æ˜¯ä¸€å€‹çµ„åˆå•é¡Œï¼Œæ ¸å¿ƒåœ¨æ–¼<b>å¦‚ä½•å°‡ç•¶å‰æ•¸å­—èˆ‡å‰ä¸€å€‹æ•¸å­—é€²è¡Œæœ‰æ•ˆåˆ‡å‰²</b>ã€‚</div>

            <h4>ğŸ’¡ è§£æ³•æ¼”é€²</h4>
            <div id="algoDetail" class="logic-card"></div>

            <h4>âš¡ è¤‡é›œåº¦åˆ†æ</h4>
            <div class="section-box">
                <div id="compTime" style="color: var(--purple); font-weight: bold;"></div>
                <div id="compSpace" style="color: var(--blue); font-weight: bold; margin-top: 4px;"></div>
            </div>

            <h4>ğŸ“ ç‹€æ…‹è½‰ç§»æ–¹ç¨‹</h4>
            <div class="logic-card" style="border-style: solid; border-color: #30363d; font-family: monospace;">
                # å–®ä½å…ƒè§£ç¢¼<br>
                if s[i-1] != '0': dp[i] += dp[i-1]<br>
                # é›™ä½å…ƒè§£ç¢¼<br>
                if 10 <= int(s[i-2:i]) <= 26:<br>
                &nbsp;&nbsp;dp[i] += dp[i-2]
            </div>
        </div>

        <div class="workspace">
            <div class="tabs" id="tabBar"></div>
            <div id="codeEditor" class="editor"></div>

            <div class="viz-section">
                <div class="viz-main">
                    <div class="string-row" id="stringDisplay"></div>
                    <div style="font-size: 10px; color: #484f58; margin-bottom: 10px; font-weight: bold; letter-spacing: 1px;">DP TABLE / STATE TRACKER</div>
                    <div class="dp-row" id="dpTable"></div>
                </div>
                <div class="terminal" id="terminal">
                    <div style="color: #484f58; font-size: 11px; margin-bottom: 10px;">DEBUG CONSOLE</div>
                    <div id="logContent"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
let curStep = 0, s = "", steps = [], curAlgo = 'dp_iter';

const repo = {
    recursive: {
        name: "1. Recursive", time: "O(2â¿)", space: "O(n)", 
        detail: "ç´”éè¿´ï¼šè‡ªé ‚å‘ä¸‹ã€‚å°æ–¼æ¯å€‹ä½ç½® iï¼Œåˆ†è£‚å‡ºå…©æ¢è·¯å¾‘ï¼ˆå– 1 ä½æˆ–å– 2 ä½ï¼‰ã€‚æœƒç”¢ç”Ÿå¤§é‡é‡è¤‡è¨ˆç®—ã€‚",
        code: [`<span class="kw">def</span> <span class="fn">dfs</span>(i):`, `    <span class="kw">if</span> i == <span class="fn">len</span>(s): <span class="kw">return</span> <span class="num">1</span>`, `    <span class="kw">if</span> s[i] == <span class="str">"0"</span>: <span class="kw">return</span> <span class="num">0</span>`, `    res = <span class="fn">dfs</span>(i + <span class="num">1</span>)`, `    <span class="kw">if</span> i + <span class="num">1</span> < <span class="fn">len</span>(s) <span class="kw">and</span> <span class="str">"10"</span> <= s[i:i+<span class="num">2</span>] <= <span class="str">"26"</span>:`, `        res += <span class="fn">dfs</span>(i + <span class="num">2</span>)`, `    <span class="kw">return</span> res`],
        gen: (str) => {
            let steps = []; const solve = (i) => {
                steps.push({l:1, i, msg: `DFS(index: ${i})`, dp:[]});
                if(i===str.length) return 1; if(str[i]==='0') return 0;
                let r = solve(i+1); if(i+1<str.length && parseInt(str.substring(i,i+2))<=26) r+=solve(i+2);
                steps.push({l:7, i, msg: `DFS(${i}) è¿”å› ${r}`, dp:[]}); return r;
            }; solve(0); return steps;
        }
    },
    dp_memo: {
        name: "2. Top-Down (Memo)", time: "O(n)", space: "O(n)", 
        detail: "è¨˜æ†¶åŒ–ï¼šè‡ªé ‚å‘ä¸‹ã€‚ä½¿ç”¨ memo å­—å…¸å­˜å„²å·²è¨ˆç®—éçš„ dfs(i)ï¼Œç¢ºä¿æ¯å€‹ç´¢å¼•åªè¨ˆç®—ä¸€æ¬¡ã€‚",
        code: [`memo = {<span class="fn">len</span>(s): <span class="num">1</span>}`, `<span class="kw">def</span> <span class="fn">dfs</span>(i):`, `    <span class="kw">if</span> i <span class="kw">in</span> memo: <span class="kw">return</span> memo[i]`, `    <span class="kw">if</span> s[i] == <span class="str">"0"</span>: <span class="kw">return</span> <span class="num">0</span>`, `    res = <span class="fn">dfs</span>(i + <span class="num">1</span>)`, `    <span class="kw">if</span> i + <span class="num">1</span> < <span class="fn">len</span>(s) <span class="kw">and</span> <span class="str">"10"</span> <= s[i:i+<span class="num">2</span>] <= <span class="str">"26"</span>:`, `        res += <span class="fn">dfs</span>(i + <span class="num">2</span>)`, `    memo[i] = res`, `    <span class="kw">return</span> res`],
        gen: (str) => {
            let steps = [], memo = {}; memo[str.length] = 1;
            const solve = (i) => {
                if(i in memo) { steps.push({l:3, i, msg: `Memo Hit: ${i}`, dp:{...memo}}); return memo[i]; }
                if(str[i]==='0') { memo[i]=0; return 0; }
                let r = solve(i+1); if(i+1<str.length && parseInt(str.substring(i,i+2))<=26) r+=solve(i+2);
                memo[i] = r; steps.push({l:8, i, msg: `Memo Save: ${i}`, dp:{...memo}}); return r;
            }; solve(0); return steps;
        }
    },
    dp_iter: {
        name: "3. Bottom-Up DP", time: "O(n)", space: "O(n)", 
        detail: "ç–Šä»£æ³•ï¼šè‡ªåº•å‘ä¸Šã€‚ä½¿ç”¨é™£åˆ— dp[i] å¾å·¦å¾€å³æ¨å°ã€‚é€™æ˜¯é¢è©¦æœ€æ¨™æº–ã€æœ€ç©©å®šçš„è§£æ³•ã€‚",
        code: [`dp = [<span class="num">0</span>] * (n + <span class="num">1</span>)`, `dp[<span class="num">0</span>] = <span class="num">1</span>`, `dp[<span class="num">1</span>] = <span class="num">1</span> <span class="kw">if</span> s[<span class="num">0</span>] != <span class="str">"0"</span> <span class="kw">else</span> <span class="num">0</span>`, `<span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(<span class="num">2</span>, n + <span class="num">1</span>):`, `    <span class="kw">if</span> s[i-<span class="num">1</span>] != <span class="str">"0"</span>:`, `        dp[i] += dp[i-<span class="num">1</span>]`, `    <span class="kw">if</span> <span class="str">"10"</span> <= s[i-<span class="num">2</span>:i] <= <span class="str">"26"</span>:`, `        dp[i] += dp[i-<span class="num">2</span>]`],
        gen: (str) => {
            let steps = [], n=str.length, dp=new Array(n+1).fill(0);
            dp[0]=1; steps.push({l:2, i:0, msg:"dp[0]=1", dp:[...dp]});
            dp[1]=str[0]!=='0'?1:0; steps.push({l:3, i:1, msg:"dp[1] init", dp:[...dp]});
            for(let i=2; i<=n; i++){
                if(str[i-1]!=='0') dp[i]+=dp[i-1];
                if(parseInt(str.substring(i-2,i))>=10 && parseInt(str.substring(i-2,i))<=26) dp[i]+=dp[i-2];
                steps.push({l:4, i, msg:`å¡«å¯« dp[${i}]`, dp:[...dp]});
            }
            return steps;
        }
    },
    dp_opt: {
        name: "4. Space Optimized", time: "O(n)", space: "O(1)", 
        detail: "ç©ºé–“å„ªåŒ–ï¼šè§€å¯Ÿåˆ° dp[i] åªä¾è³´å‰å…©é …ï¼Œå› æ­¤åªéœ€ç¶­è­·å…©å€‹è®Šæ•¸å³å¯ï¼Œå°‡ç©ºé–“è¤‡é›œåº¦å„ªåŒ–è‡³å¸¸æ•¸ç´šã€‚",
        code: [`p2, p1 = <span class="num">1</span>, (<span class="num">1</span> <span class="kw">if</span> s[<span class="num">0</span>] != <span class="str">"0"</span> <span class="kw">else</span> <span class="num">0</span>)`, `<span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(<span class="num">1</span>, n):`, `    cur = <span class="num">0</span>`, `    <span class="kw">if</span> s[i] != <span class="str">"0"</span>: cur += p1`, `    <span class="kw">if</span> <span class="str">"10"</span> <= s[i-<span class="num">1</span>:i+<span class="num">1</span>] <= <span class="str">"26"</span>: cur += p2`, `    p2, p1 = p1, cur`],
        gen: (str) => {
            let steps=[], p2=1, p1=str[0]!=='0'?1:0;
            steps.push({l:1, i:0, msg:`Initial p2, p1`, p2, p1, dp:[]});
            for(let i=1; i<str.length; i++){
                let cur=0; if(str[i]!=='0') cur+=p1;
                if(parseInt(str.substring(i-1,i+1))>=10 && parseInt(str.substring(i-1,i+1))<=26) cur+=p2;
                steps.push({l:3, i, msg:`i=${i}, cur=${cur}`, p2, p1, cur, dp:[]});
                p2=p1; p1=cur; steps.push({l:6, i, msg:`Roll Over`, p2, p1, dp:[]});
            }
            return steps;
        }
    }
};

function init() {
    s = document.getElementById('sInput').value || "226";
    const tabBar = document.getElementById('tabBar');
    tabBar.innerHTML = Object.keys(repo).map(k => `<div class="tab ${k===curAlgo?'active':''}" onclick="changeAlgo('${k}')">${repo[k].name}</div>`).join('');
    document.getElementById('codeEditor').innerHTML = repo[curAlgo].code.map((l, i) => `<div class="line" data-ln="${i+1}">${l}</div>`).join('');
    document.getElementById('algoDetail').innerText = repo[curAlgo].detail;
    document.getElementById('compTime').innerText = `Time: ${repo[curAlgo].time}`;
    document.getElementById('compSpace').innerText = `Space: ${repo[curAlgo].space}`;
    steps = repo[curAlgo].gen(s); curStep = 0; update();
}

function update() {
    const step = steps[curStep];
    document.querySelectorAll('.line').forEach((l, i) => i===step.l-1?l.classList.add('active'):l.classList.remove('active'));
    
    let dpHTML = '';
    for(let j=0; j<=s.length; j++) {
        let val = (curAlgo==='dp_opt') ? (j===step.i+1?step.p1:(j===step.i?step.p2:'-')) : (step.dp[j]??'-');
        dpHTML += `<div class="dp-box ${j===(curAlgo==='dp_opt'?step.i+1:step.i)?'active':''}">
            <div class="dp-label">${curAlgo==='dp_opt'?(j===step.i+1?'p1':'p2'):'dp['+j+']'}</div>
            <div class="dp-val">${val}</div>
        </div>`;
    }
    document.getElementById('dpTable').innerHTML = dpHTML;

    document.getElementById('stringDisplay').innerHTML = s.split('').map((c, idx) => `
        <div class="char-cell ${idx===step.i?'active':''}">
            ${idx===step.i?'<div class="ptr-i">i</div>':''}${c}
        </div>`).join('');

    document.getElementById('logContent').innerHTML = `<div class="log-entry">> ${step.msg}</div>`;
}

function changeAlgo(a) { curAlgo = a; init(); }
function nextStep() { if(curStep < steps.length-1) { curStep++; update(); } }
function prevStep() { if(curStep > 0) { curStep--; update(); } }
init();
</script>
</body>
</html>
