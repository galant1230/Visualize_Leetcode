<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>Set Matrix Zeroes - Final Edition</title>
    <style>
        :root {
            --bg: #0d1117; --card: #161b22; --accent: #58a6ff;
            --pacific: #1f6feb; --atlantic: #238636; --energy: #d29922; --danger: #f85149;
            --editor-bg: #010409; --text: #c9d1d9; --dim: #8b949e;
            --keyword: #ff7b72; --hl: rgba(88, 166, 255, 0.15);
        }
        body { font-family: 'Consolas', 'Segoe UI', monospace; background: var(--bg); color: var(--text); margin: 0; padding: 15px; overflow: hidden; }
        
        .container { 
            max-width: 1850px; margin: auto; 
            display: grid; grid-template-columns: 350px 1.2fr 480px; gap: 20px; height: 95vh; 
        }

        /* å·¦å´é¢æ¿ - å®Œæ•´è³‡è¨Š */
        .side-panel { background: var(--card); border: 1px solid #30363d; border-radius: 12px; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px; }
        .info-card { background: #010409; border: 1px solid #30363d; padding: 14px; border-radius: 8px; font-size: 13px; line-height: 1.6; }
        .ex-box { background: #161b22; border-left: 3px solid var(--accent); padding: 10px; margin-top: 8px; font-size: 12px; color: var(--dim); }
        .tag { padding: 3px 8px; border-radius: 4px; font-size: 11px; font-weight: bold; background: rgba(88, 166, 255, 0.1); color: var(--accent); margin-right: 5px; }

        /* ä¸­é–“è¦–è¦ºåŒ– */
        .main-panel { background: #010409; border: 1px solid #30363d; border-radius: 12px; padding: 20px; display: flex; flex-direction: column; gap: 15px; overflow: hidden; }
        .viz-area { 
            background: var(--card); border-radius: 8px; padding: 20px; border: 1px solid #333; 
            position: relative; min-height: 350px; display: flex; flex-direction: column; justify-content: center; align-items: center; 
        }
        .matrix-grid { display: grid; gap: 8px; position: relative; }
        .cell {
            width: 55px; height: 55px; display: flex; align-items: center; justify-content: center;
            background: #21262d; border: 1px solid #30363d; border-radius: 4px; font-weight: bold; font-size: 20px;
            transition: all 0.3s ease;
        }
        .cell.marker-zone { border: 2px dashed #444; color: var(--accent); }
        .cell.is-zero { background: var(--danger); color: white; border-color: #ff7b72; }
        .cell.marked { background: var(--energy); color: white; transform: scale(1.05); }
        .cell.final-zero { background: #484f58; color: #8b949e; opacity: 0.6; }
        .cell.active { border-color: var(--accent); box-shadow: 0 0 15px var(--accent); z-index: 10; }

        /* å³å´ä»£ç¢¼ */
        .editor { background: var(--editor-bg); border: 1px solid #30363d; border-radius: 12px; overflow: hidden; width: 480px; }
        .ln { white-space: pre; padding: 0 15px 0 65px; position: relative; line-height: 1.5; font-size: 12px; }
        .ln-num { position: absolute; left: 0; width: 50px; text-align: right; color: #484f58; padding-right: 15px; border-right: 1px solid #30363d; }
        .ln-active { background: var(--hl); border-left: 4px solid var(--accent); }
        .kw { color: var(--keyword); }

        .toolbar { grid-column: span 3; background: var(--card); padding: 12px 20px; border-radius: 12px; display: flex; justify-content: space-between; border: 1px solid #30363d; }
        .btn { background: var(--pacific); color: white; border: none; padding: 10px 24px; border-radius: 6px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <div class="toolbar">
        <div style="font-weight:bold; color:var(--accent); font-size:20px;">73. Set Matrix Zeroes <span style="font-size:13px; color:var(--dim);">Constant Space Analysis</span></div>
        <div style="display:flex; gap:12px;">
            <button class="btn" id="nextBtn" onclick="next()">ä¸‹ä¸€æ­¥ Step ğŸ§­</button>
            <button class="btn" style="background:#21262d" onclick="init()">é‡ç½®</button>
        </div>
    </div>

    <div class="side-panel">
        <div class="info-card">
            <b style="color:var(--accent); font-size:15px;">ğŸ“– é¡Œç›®æè¿°</b><br>
            çµ¦äºˆä¸€å€‹ <code>m x n</code> çŸ©é™£ï¼Œè‹¥æŸå€‹å…ƒç´ ç‚º 0ï¼Œå‰‡å°‡å…¶æ‰€åœ¨çš„æ•´åˆ—å’Œæ•´è¡Œéƒ½æ­¸é›¶ã€‚å¿…é ˆåŸåœ°ä¿®æ”¹ã€‚
        </div>

        <div class="info-card">
            <b style="color:var(--energy); font-size:15px;">ğŸ’¡ ç¯„ä¾‹è§£æ</b>
            <div class="ex-box">
                <b>Example 1:</b><br>
                Input: [[1,1,1],[1,0,1],[1,1,1]]<br>
                Output: [[1,0,1],[0,0,0],[1,0,1]]
            </div>
            <div class="ex-box">
                <b>Example 2:</b><br>
                Input: [[0,1,2,0],[3,4,5,2],[1,3,1,5]]<br>
                Output: [[0,0,0,0],[0,4,5,0],[0,3,1,0]]
            </div>
        </div>

        <div class="info-card">
            <b style="color:var(--atlantic); font-size:15px;">ğŸ§  æ ¸å¿ƒç­–ç•¥ï¼š$O(1)$ ç©ºé–“</b><br>
            ç‚ºäº†ä¸ä½¿ç”¨é¡å¤–é™£åˆ—ï¼Œæˆ‘å€‘åˆ©ç”¨ <b>çŸ©é™£çš„ç¬¬ä¸€åˆ—èˆ‡ç¬¬ä¸€è¡Œ</b> ç•¶ä½œè¼”åŠ©ç©ºé–“ï¼š<br>
            1. æª¢æŸ¥ç¬¬ä¸€è¡Œ/åˆ—æœ¬èº«æ˜¯å¦å« 0ã€‚<br>
            2. éæ­·å…§å±¤å…ƒç´ ï¼Œè‹¥ç™¼ç¾ 0ï¼Œå‰‡åœ¨å°æ‡‰çš„é‚Šç•Œï¼ˆçœ‹æ¿ï¼‰æ‰“è¨˜è™Ÿã€‚<br>
            3. æ ¹æ“šçœ‹æ¿è¨˜è™Ÿï¼Œå›é ­å°‡å…§å±¤æ­¸é›¶ã€‚<br>
            4. æœ€å¾Œè™•ç†ç¬¬ä¸€è¡Œ/åˆ—çš„æ­¸é›¶ã€‚
        </div>

        <div class="info-card">
            <span class="tag">Time: O(M * N)</span>
            <span class="tag">Space: O(1)</span>
        </div>
    </div>

    <div class="main-panel">
        <div class="viz-area">
            <div id="matrixGrid" class="matrix-grid"></div>
        </div>
        <div id="log" style="color:var(--accent); font-size:14px; font-weight:bold; text-align:center; padding:10px; background: rgba(88,166,255,0.05); border-radius: 8px;"></div>
    </div>

    <div class="editor">
        <div style="background:#161b22; padding:12px; font-size:13px; color:var(--dim); border-bottom:1px solid #30363d;">In-place Algorithm</div>
        <div id="codeView" style="padding-top:10px;"></div>
    </div>
</div>

<script>
const codeSteps = [
    "rows, cols = len(matrix), len(matrix[0])",
    "row0 = any(matrix[0][j] == 0 for j in range(cols))",
    "col0 = any(matrix[i][0] == 0 for i in range(rows))",
    "for i in range(1, rows):",
    "    for j in range(1, cols):",
    "        if matrix[i][j] == 0:",
    "            matrix[i][0] = 0",
    "            matrix[0][j] = 0",
    "for i in range(1, rows):",
    "    for j in range(1, cols):",
    "        if matrix[i][0] == 0 or matrix[0][j] == 0:",
    "            matrix[i][j] = 0",
    "if row0:",
    "    for j in range(cols): matrix[0][j] = 0",
    "if col0:",
    "    for i in range(rows): matrix[i][0] = 0"
];

const matrix = [[1, 1, 1], [1, 0, 1], [1, 1, 1]];
let cur;
let it;

function init() {
    cur = JSON.parse(JSON.stringify(matrix));
    render();
    document.getElementById('codeView').innerHTML = codeSteps.map((l, i) => {
        const f = l.replace(/any|if|for|in|len|range|==/g, '<span class="kw">$&</span>');
        return `<div class="ln" id="ln-${i}"><span class="ln-num">${i}</span>${f}</div>`;
    }).join('');
    document.getElementById('nextBtn').disabled = false;
    it = logic();
}

function render(active=[], marked=[], final=[]) {
    const grid = document.getElementById('matrixGrid');
    grid.style.gridTemplateColumns = `repeat(${cur[0].length}, 1fr)`;
    grid.innerHTML = '';
    cur.forEach((row, r) => {
        row.forEach((val, c) => {
            const div = document.createElement('div');
            div.className = 'cell';
            if (r===0 || c===0) div.classList.add('marker-zone');
            if (val===0) div.classList.add('is-zero');
            if (active.some(a=>a[0]===r && a[1]===c)) div.classList.add('active');
            if (marked.some(m=>m[0]===r && m[1]===c)) div.classList.add('marked');
            if (final.some(f=>f[0]===r && f[1]===c)) div.classList.add('final-zero');
            div.innerText = val;
            grid.appendChild(div);
        });
    });
}

function* logic() {
    const R = cur.length, C = cur[0].length;
    yield { ln: 1, m: "æª¢æŸ¥ç¬¬ä¸€åˆ—èˆ‡ç¬¬ä¸€è¡Œæ˜¯å¦æœ‰ 0..." };
    let row0 = cur[0].some(v => v === 0);
    let col0 = cur.some(r => r[0] === 0);

    yield { ln: 3, m: "é–‹å§‹æƒæå…§å±¤å…ƒç´ ï¼Œä¸¦åœ¨æ¨™è¨˜çœ‹æ¿æ‰“ä¸Šè¨˜è™Ÿã€‚" };
    let marks = [];
    for (let i=1; i<R; i++) {
        for (let j=1; j<C; j++) {
            render([[i,j]], marks);
            if (cur[i][j] === 0) {
                cur[i][0] = 0; cur[0][j] = 0;
                marks.push([i,0], [0,j]);
                render([[i,j]], marks);
                yield { ln: 6, m: `ç™¼ç¾å…§å±¤ 0ï¼æ¨™è¨˜é‚Šç•Œ [${i},0] èˆ‡ [0,${j}]ã€‚` };
            } else {
                yield { ln: 5, m: `æƒæå…§å±¤ [${i},${j}]...` };
            }
        }
    }

    yield { ln: 8, m: "æ ¹æ“šæ¨™è¨˜çœ‹æ¿ï¼Œé–‹å§‹æ­¸é›¶å…§å±¤å…ƒç´ ã€‚" };
    let finals = [];
    for (let i=1; i<R; i++) {
        for (let j=1; j<C; j++) {
            if (cur[i][0] === 0 || cur[0][j] === 0) {
                cur[i][j] = 0; finals.push([i,j]);
                render([[i,j]], marks, finals);
                yield { ln: 11, m: `å°æ‡‰çœ‹æ¿æœ‰è¨˜è™Ÿï¼Œå°‡ [${i},${j}] æ­¸é›¶ã€‚` };
            }
        }
    }

    if (row0) {
        for(let j=0; j<C; j++) { cur[0][j]=0; finals.push([0,j]); }
        yield { ln: 13, m: "æœ€å¾Œè™•ç†ï¼šç¬¬ä¸€åˆ—åŸæœ¬æœ‰ 0ï¼Œæ•´åˆ—æ­¸é›¶ã€‚" };
        render([], marks, finals);
    }
    if (col0) {
        for(let i=0; i<R; i++) { cur[i][0]=0; finals.push([i,0]); }
        yield { ln: 15, m: "æœ€å¾Œè™•ç†ï¼šç¬¬ä¸€è¡ŒåŸæœ¬æœ‰ 0ï¼Œæ•´è¡Œæ­¸é›¶ã€‚" };
        render([], marks, finals);
    }
}

function next() {
    const s = it.next();
    if (s.done) { document.getElementById('nextBtn').disabled=true; return; }
    document.querySelectorAll('.ln').forEach(l=>l.classList.remove('ln-active'));
    document.getElementById(`ln-${s.value.ln}`).classList.add('ln-active');
    document.getElementById('log').innerText = `> ${s.value.m}`;
}
init();
</script>
</body>
</html>
