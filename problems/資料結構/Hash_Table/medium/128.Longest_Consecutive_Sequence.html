<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>128. Longest Consecutive Sequence è¦–è¦ºåŒ–</title>
  <style>
    :root {
      --primary: #007acc; --success: #2ecc71; --warning: #f39c12;
      --danger: #e74c3c; --dark: #2c3e50; --bg: #f4f7f9;
    }
    body { font-family: 'Segoe UI', sans-serif; background: var(--bg); padding: 20px; color: var(--dark); line-height: 1.6; }
    .dashboard { max-width: 1200px; margin: auto; display: grid; grid-template-columns: 1fr 1.2fr; gap: 20px; }
    
    .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
    .full-width { grid-column: span 2; }
    h2 { margin-top: 0; color: var(--primary); border-bottom: 2px solid #eee; padding-bottom: 10px; font-size: 1.25rem; }
    
    /* é¡Œç›®è³‡è¨Š */
    .problem-info { display: flex; gap: 20px; margin-bottom: 10px; align-items: flex-start; }
    .example-box { background: #f8f9fa; padding: 15px; border-left: 4px solid var(--warning); font-family: monospace; flex: 1; }

    /* æ§åˆ¶é¢æ¿ */
    .controls { display: flex; gap: 10px; margin: 20px 0; justify-content: center; align-items: center; }
    input { padding: 8px 15px; border: 2px solid #ddd; border-radius: 25px; outline: none; width: 250px; }
    button { padding: 8px 25px; border: none; border-radius: 25px; cursor: pointer; background: var(--primary); color: white; font-weight: bold; }
    button:disabled { background: #ccc; }

    /* è¦–è¦ºåŒ–å…ƒä»¶ */
    .set-container { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin: 20px 0; min-height: 100px; }
    .num-node { 
      width: 50px; height: 50px; border: 2px solid #ddd; border-radius: 50%; 
      display: flex; align-items: center; justify-content: center; font-weight: bold;
      background: white; transition: all 0.3s; position: relative;
    }
    .num-node.is-start { border-color: var(--success); background: #e8f5e9; border-width: 3px; }
    .num-node.checking { transform: scale(1.2); border-color: var(--warning); box-shadow: 0 0 10px rgba(243, 156, 18, 0.5); }
    .num-node.in-sequence { background: var(--success); color: white; border-color: #1b5e20; }
    .num-node.not-start { opacity: 0.5; border-style: dashed; }

    /* ä»£ç¢¼è¦–çª— */
    .code-window { background: #282c34; color: #abb2bf; padding: 20px; border-radius: 8px; font-family: 'Consolas', monospace; font-size: 0.9rem; line-height: 1.6; }
    .line { padding: 0 10px; border-left: 4px solid transparent; white-space: pre; }
    .line.active { background: #3e4451; border-left-color: var(--success); color: white; }
    
    .status-msg { font-weight: bold; color: var(--primary); text-align: center; height: 1.5rem; margin-bottom: 10px; }
    .stats { display: flex; justify-content: space-around; background: #eee; padding: 10px; border-radius: 8px; font-family: monospace; }
  </style>
</head>
<body>

<div class="dashboard">
  <div class="card full-width">
    <h2>ğŸ“Œ 128. Longest Consecutive Sequence</h2>
    <div class="problem-info">
      <div>
        <p><strong>ç›®æ¨™ï¼š</strong> çµ¦å®šæœªæ’åºé™£åˆ—ï¼Œæ‰¾å‡ºæ•¸å­—é€£çºŒå‡ºç¾çš„æœ€é•·é•·åº¦ã€‚</p>
        <p><strong>æ ¸å¿ƒæ€ç¶­ï¼š</strong>
          <br>1. å°‡æ‰€æœ‰æ•¸å­—æ”¾å…¥ <strong>Set</strong>ï¼Œå¯¦ç¾ O(1) æŸ¥è©¢ã€‚
          <br>2. åªå¾ã€Œåºåˆ—çš„ç¬¬ä¸€å€‹æ•¸å­—ã€é–‹å§‹å¾€å¾Œæ•¸ï¼ˆå³ <code>num - 1</code> ä¸åœ¨ Set ä¸­ï¼‰ã€‚
        </p>
      </div>
      <div class="example-box">
        ç¯„ä¾‹ï¼šnums = [100, 4, 200, 1, 3, 2]<br>
        é€£çºŒåºåˆ—æœ‰: [1, 2, 3, 4], [100], [200]<br>
        æœ€é•·é•·åº¦: 4
      </div>
    </div>

    <div class="controls">
      è¼¸å…¥æ•¸å­—: <input type="text" id="inputNums" value="100, 4, 200, 1, 3, 2">
      <button onclick="initSim()">é‡ç½®ä¸¦è½‰æ›ç‚º Set</button>
      <button id="nextBtn" onclick="runStep()">ä¸‹ä¸€æ­¥ (Step)</button>
    </div>
  </div>

  <div class="card">
    <h2>ğŸ§© Set ç‹€æ…‹èˆ‡è¿½è¹¤</h2>
    <div class="status-msg" id="statusMsg">æº–å‚™é–‹å§‹</div>
    <div class="set-container" id="setArea"></div>
    <div class="stats">
      <span>Current: <b id="currLen">0</b></span>
      <span>Longest: <b id="maxLen">0</b></span>
    </div>
  </div>

  <div class="card">
    <h2>Python å¯¦ä½œ</h2>
    <div class="code-window" id="codeDisplay">
<div class="line" id="l1">numSet = set(nums)</div>
<div class="line" id="l2">longest = 0</div>
<div class="line" id="l3">for num in numSet:</div>
<div class="line" id="l4">    if (num - 1) not in numSet:</div>
<div class="line" id="l5">        length = 1</div>
<div class="line" id="l6">        while (num + length) in numSet:</div>
<div class="line" id="l7">            length += 1</div>
<div class="line" id="l8">        longest = max(length, longest)</div>
    </div>
  </div>
</div>

<script>
let numSet = [], sortedNums = [], currentIndex = 0, longest = 0, state = "loop";
let currentSequenceLength = 0, startNum = 0;

function initSim() {
  const input = document.getElementById('inputNums').value;
  const raw = input.split(',').map(n => parseInt(n.trim())).filter(n => !isNaN(n));
  numSet = Array.from(new Set(raw));
  // ç‚ºäº†è¦–è¦ºåŒ–æ–¹ä¾¿ï¼Œæˆ‘å€‘æŠŠ Set è£¡çš„æ•¸å­—åˆ—å‡ºä¾†
  currentIndex = 0; longest = 0; state = "loop";
  document.getElementById('nextBtn').disabled = false;
  document.getElementById('maxLen').innerText = "0";
  document.getElementById('currLen').innerText = "0";
  document.getElementById('statusMsg').innerText = "å·²å»ºç«‹ Setï¼Œé–‹å§‹éæ­·";
  render();
}

function render() {
  const area = document.getElementById('setArea');
  area.innerHTML = numSet.map((val, idx) => {
    let cls = 'num-node';
    if (state === "loop" && idx === currentIndex) cls += ' checking';
    if (state === "while" && val >= startNum && val < startNum + currentSequenceLength) cls += ' in-sequence';
    return `<div class="${cls}" id="node-${val}">${val}</div>`;
  }).join('');
}

function runStep() {
  document.querySelectorAll('.line').forEach(l => l.classList.remove('active'));
  const msg = document.getElementById('statusMsg');
  
  if (currentIndex >= numSet.length && state === "loop") {
    msg.innerText = "å…¨éƒ¨æª¢æŸ¥å®Œç•¢ï¼";
    document.getElementById('nextBtn').disabled = true;
    return;
  }

  const num = numSet[currentIndex];

  if (state === "loop") {
    document.getElementById('l3').classList.add('active');
    document.getElementById('l4').classList.add('active');
    
    const isStart = !numSet.includes(num - 1);
    if (isStart) {
      msg.innerText = `${num} çš„å·¦é‚Šæ²’æœ‰æ•¸å­— (${num-1} ä¸åœ¨ Set)ï¼Œå®ƒæ˜¯åºåˆ—èµ·é»ï¼`;
      state = "while";
      startNum = num;
      currentSequenceLength = 1;
      document.getElementById('l5').classList.add('active');
    } else {
      msg.innerText = `${num} ä¸æ˜¯èµ·é»ï¼Œå› ç‚º ${num-1} å·²å­˜åœ¨æ–¼ Setï¼Œè·³éã€‚`;
      currentIndex++;
    }
  } else if (state === "while") {
    document.getElementById('l6').classList.add('active');
    if (numSet.includes(startNum + currentSequenceLength)) {
      msg.innerText = `æ‰¾åˆ°é€£çºŒæ•¸å­—: ${startNum + currentSequenceLength}`;
      currentSequenceLength++;
      document.getElementById('l7').classList.add('active');
    } else {
      document.getElementById('l8').classList.add('active');
      longest = Math.max(longest, currentSequenceLength);
      msg.innerText = `åºåˆ—çµæŸï¼Œé•·åº¦ç‚º ${currentSequenceLength}`;
      document.getElementById('maxLen').innerText = longest;
      state = "loop";
      currentIndex++;
    }
  }
  
  document.getElementById('currLen').innerText = currentSequenceLength;
  render();
}

initSim();
</script>
</body>
</html>