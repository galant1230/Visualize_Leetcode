<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>417. å¤ªå¹³æ´‹å¤§è¥¿æ´‹æ°´æµæ¨¡æ“¬å™¨ - DFS æ¨¡å¼</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #f9f9f9; padding: 2rem; margin: 0; color: #333; }
    h2, h3, h4 { color: #007acc; }
    .container {
      max-width: 1200px; margin: auto; background: #fff; padding: 2rem;
      border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }
    table { margin: 0.5rem auto; border-collapse: collapse; }
    td {
      width: 40px; height: 40px; text-align: center; vertical-align: middle;
      border: 1px solid #ccc; font-size: 14px;
    }
    .pacific { background-color: #2196F3; color: white; }
    .atlantic { background-color: #4CAF50; color: white; }
    .both { background-color: orange; color: white; }
    .active-cell { outline: 3px solid red; font-weight: bold; }
    .visited-true { background-color: #c8e6c9; }
    #codeBox {
      background: #272822; color: #f8f8f2; padding: 1rem;
      border-radius: 6px; margin: 2rem 0; font-family: monospace; white-space: pre-wrap;
    }
    .matrix-row {
      display: flex;
      justify-content: space-around;
      align-items: flex-start;
      gap: 2rem;
      margin-top: 2rem;
      flex-wrap: wrap;
    }
    .matrix-col {
      text-align: center;
    }
    button {
      padding: 8px 16px; font-size: 14px; margin: 0.3rem;
      cursor: pointer; border: none; border-radius: 6px;
      background: #007acc; color: white;
    }
    input { width: 400px; padding: 5px; }
    .status-box {
      margin-top: 1rem;
      padding: 1rem;
      background: #eef5ff;
      border-left: 5px solid #007acc;
      font-family: monospace;
      white-space: pre-wrap;
    }
    .toggle-debug {
      font-size: 12px; background: #ccc; color: #000;
    }
  </style>
</head>
<body>
<div class="container">
  <h2>ğŸ’§ 417. å¤ªå¹³æ´‹å¤§è¥¿æ´‹æ°´æµå•é¡Œï¼ˆDFS é€æ­¥æ¨¡æ“¬ï¼‰</h2>
  <hr>
  <h3>ğŸ“˜ é¡Œç›®æè¿°</h3>
  <p>çµ¦å®šä¸€å€‹ m x n çš„æ•´æ•¸çŸ©é™£ heights ï¼Œå…¶ä¸­ heights[r][c] è¡¨ç¤ºå–®å…ƒæ ¼ (r, c) çš„é«˜åº¦ã€‚
  é›¨æ°´å¯ä»¥å¾è¼ƒé«˜æˆ–ç›¸ç­‰é«˜åº¦çš„å–®å…ƒæ ¼æµåˆ°ç›¸é„°çš„å–®å…ƒæ ¼ï¼ˆä¸Šä¸‹å·¦å³ï¼‰ï¼Œè«‹æ‰¾å‡ºæ‰€æœ‰èƒ½åŒæ™‚æµåˆ°ã€Œå¤ªå¹³æ´‹ã€å’Œã€Œå¤§è¥¿æ´‹ã€çš„æ ¼å­ã€‚
  å¤ªå¹³æ´‹ä½æ–¼çŸ©é™£çš„å·¦é‚Šèˆ‡ä¸Šé‚Šï¼›å¤§è¥¿æ´‹ä½æ–¼çŸ©é™£çš„å³é‚Šèˆ‡ä¸‹é‚Šã€‚</p>

  <h3>ğŸ§ª è¼¸å…¥</h3>
  <input type="text" id="matrixInput" value="[[1,2,2,3,5],[3,2,3,4,4],[2,4,5,3,1],[6,7,1,4,5],[5,1,1,2,4]]">
  <button onclick="initSim()">ğŸ”ƒ é‡è¨­</button>
  <button onclick="stepSim()">ğŸ§­ ä¸‹ä¸€æ­¥</button>
  <button onclick="toggleDebug()" class="toggle-debug">ğŸ› ï¸ åˆ‡æ› è©³ç´°/ç²¾ç°¡ æ¨¡å¼</button>
  <p id="stepInfo"></p>

  <div class="matrix-row">
    <div class="matrix-col">
      <h4>ğŸŒŠ ä¸»çŸ©é™£</h4>
      <div id="grid"></div>
    </div>
    <div class="matrix-col">
      <h4>ğŸŒŠ å¤ªå¹³æ´‹ visited ç‹€æ…‹</h4>
      <div id="pacificGrid"></div>
    </div>
    <div class="matrix-col">
      <h4>ğŸŒŠ å¤§è¥¿æ´‹ visited ç‹€æ…‹</h4>
      <div id="atlanticGrid"></div>
    </div>
  </div>

  <div class="status-box" id="debugBox" style="display: none;"></div>

  <h3>ğŸ“„ DFS æ¨¡æ“¬ç¨‹å¼ç¢¼</h3>
  <div id="codeBox"></div>
</div>

<script>
let matrix, m, n;
let pacific, atlantic;
let dfsStack = [], stepInfo;
let currentOcean = "Pacific";
let debugMode = false;

const dfsCode = `class Solution:
    def check(self, row, col, heights, ocean):
        ocean[row][col] = True
        lst = [[row + 1, col],[row - 1, col],[row, col - 1],[row, col + 1]] # ä¸Šä¸‹å·¦å³
        for r, c in lst:
            if (0 <= r < len(heights) and 
                0 <= c < len(heights[0]) and
                not ocean[r][c] and
                heights[r][c] >= heights[row][col]
            ):
                self.check(r, c, heights, ocean)
        return

    def pacificAtlantic(self, heights: List[List[int]]) -> List[List[int]]:
        if not heights or not heights[0]:
            return []

        rows, cols = len(heights), len(heights[0])
        pac = [[False for _ in range(cols)] for _ in range(rows)]
        atl = [[False for _ in range(cols)] for _ in range(rows)]

        for i in range(rows):
            self.check(i, 0, heights, pac)           # å·¦é‚Šï¼ˆå¤ªå¹³æ´‹ï¼‰
            self.check(i, cols - 1, heights, atl)    # å³é‚Šï¼ˆå¤§è¥¿æ´‹ï¼‰

        for j in range(cols):
            self.check(0, j, heights, pac)           # ä¸Šé‚Šï¼ˆå¤ªå¹³æ´‹ï¼‰
            self.check(rows - 1, j, heights, atl)    # ä¸‹é‚Šï¼ˆå¤§è¥¿æ´‹ï¼‰

        result = []
        for r in range(rows):
            for c in range(cols):
                if pac[r][c] and atl[r][c]:
                    result.append([r, c])
        return result
`;

document.getElementById("codeBox").innerText = dfsCode;

function renderMatrix(id, mat) {
  const container = document.getElementById(id);
  container.innerHTML = "<table>" +
    mat.map(row => "<tr>" +
      row.map(cell => `<td class='${cell ? "visited-true" : ""}'>${cell ? "âœ…" : ""}</td>`).join('') +
    "</tr>").join('') + "</table>";
}

function createGrid(active = null) {
  const grid = document.getElementById("grid");
  grid.innerHTML = "<table>" +
    matrix.map((row, r) => "<tr>" +
      row.map((val, c) => {
        let cls = "";
        if (pacific[r][c] && atlantic[r][c]) cls = "both";
        else if (pacific[r][c]) cls = "pacific";
        else if (atlantic[r][c]) cls = "atlantic";
        if (active && active[0] === r && active[1] === c) cls += " active-cell";
        return `<td class='${cls}'>${val}</td>`;
      }).join('') + "</tr>").join('') + "</table>";

  renderMatrix("pacificGrid", pacific);
  renderMatrix("atlanticGrid", atlantic);
}

function toggleDebug() {
  debugMode = !debugMode;
  document.getElementById("debugBox").style.display = debugMode ? "block" : "none";
}

function logDebug(msg) {
  if (!debugMode) return;
  const box = document.getElementById("debugBox");
  box.innerText += msg + "\n";
  box.scrollTop = box.scrollHeight;
}

function initSim() {
  matrix = JSON.parse(document.getElementById("matrixInput").value);
  m = matrix.length;
  n = matrix[0].length;
  pacific = Array.from({ length: m }, () => Array(n).fill(false));
  atlantic = Array.from({ length: m }, () => Array(n).fill(false));
  dfsStack = [];

  for (let i = 0; i < m; i++) {
    dfsStack.push([i, 0, pacific, -1, "Pacific"]);
    dfsStack.push([i, n - 1, atlantic, -1, "Atlantic"]);
  }
  for (let j = 0; j < n; j++) {
    dfsStack.push([0, j, pacific, -1, "Pacific"]);
    dfsStack.push([m - 1, j, atlantic, -1, "Atlantic"]);
  }

  document.getElementById("stepInfo").innerText = "ğŸ” åˆå§‹åŒ–å®Œæˆï¼Œè«‹é»ã€ä¸‹ä¸€æ­¥ã€æ¨¡æ“¬ DFS æµç¨‹";
  document.getElementById("debugBox").innerText = "";
  createGrid();
}

function stepSim() {
  while (dfsStack.length > 0) {
    const [row, col, visited, prev, oceanName] = dfsStack.pop();
    currentOcean = oceanName;
    if (row < 0 || col < 0 || row >= m || col >= n || visited[row][col]) continue;
    if (prev !== -1 && matrix[row][col] < prev) continue;
    visited[row][col] = true;

    const lst = [
      [row + 1, col],
      [row - 1, col],
      [row, col - 1],
      [row, col + 1]
    ];
    for (const [r, c] of lst) {
      dfsStack.push([r, c, visited, matrix[row][col], oceanName]);
    }
    createGrid([row, col]);
    document.getElementById("stepInfo").innerText = `ğŸ§­ ${oceanName} - DFS æ¢ç´¢ (${row}, ${col}) é«˜åº¦: ${matrix[row][col]}`;
    logDebug(`âœ… è¨ªå• (${row}, ${col}) - ä¾†è‡ª ${oceanName}ï¼Œé«˜åº¦ ${matrix[row][col]}`);
    return;
  }
  document.getElementById("stepInfo").innerText = "âœ… DFS æ¨¡æ“¬å®Œæˆï¼";
  logDebug("ğŸ‰ æ‰€æœ‰ DFS éæ­·å·²å®Œæˆï¼");
}
</script>
</body>
</html>

